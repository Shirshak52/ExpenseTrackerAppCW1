@using ExpenseTracker.Models
@using ExpenseTracker.Services
@using Microsoft.AspNetCore.Components.Forms
@using MudBlazor
@inject IAuthService AuthService
@inject NavigationManager NavigationManager

<EditForm Model="@user" OnValidSubmit="HandleLogin">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <MudTextField @bind-Value="@user.Username" Label="Username" Variant="Variant.Text"></MudTextField>
    <MudTextField @bind-Value="@user.Password" Label="Password" Variant="Variant.Text"></MudTextField>

    <MudSelect @bind-Value="@user.PreferredCurrency" Label="Preferred Currency" Variant="Variant.Outlined">
        @foreach (var currency in currencies)
        {
            <MudSelectItem Value="@currency">@currency</MudSelectItem>
        }
    </MudSelect>

    <MudButton ButtonType="ButtonType.Button" Variant="Variant.Filled" Class="ml-auto">Login</MudButton>
</EditForm>


@code {
    private User user = new User();
    private string errorMessage = string.Empty;
    private List<string> currencies = new List<string>() {"NPR", "USD"};

    // Handle login logic
    private void HandleLogin()
    {
        // Save the user credentials
        AuthService.SaveUser(user.Username, user.Password, user.PreferredCurrency);

        // Navigate to dashboard
        NavigationManager.NavigateTo("/dashboard");
    }
}


